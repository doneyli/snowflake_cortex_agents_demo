name: heidelberg
tables:
  - name: JOBS
    base_table:
      database: CORTEX_AGENTS_DEMO
      schema: HEIDELBERG
      table: JOBS
    dimensions:
      - name: JOB_ID
        expr: JOB_ID
        data_type: VARCHAR(16777216)
        description: Unique identifier for a specific job or task within the organization.
        sample_values:
          - JOB_000101
          - JOB_000102
          - JOB_000103
        synonyms:
          - job_number
          - job_reference
          - job_code
          - job_identifier
          - task_id
          - work_order_id
          - job_key
      - name: JOB_NAME
        expr: JOB_NAME
        data_type: VARCHAR(16777216)
        description: The name of the print job, which uniquely identifies a specific print production run.
        sample_values:
          - Print Job 1
          - Print Job 2
          - Print Job 3
        synonyms:
          - job_title
          - position
          - role
          - occupation
          - job_description
          - job_label
          - task_name
          - assignment_name
      - name: CUSTOMER_ID
        expr: CUSTOMER_ID
        data_type: VARCHAR(16777216)
        description: Unique identifier for the customer associated with the job.
        sample_values:
          - C_000003
          - C_000002
          - C_000005
        synonyms:
          - client_id
          - account_id
          - user_id
          - customer_account_number
          - client_number
          - account_number
          - user_number
      - name: STATUS
        expr: STATUS
        data_type: VARCHAR(16777216)
        description: 'The current state of a job. Every job goes through the following steps: Pending, In Progress and then it either goes into Cancelled or Completed.'
        sample_values:
          - Canceled
          - Completed
          - Pending
        synonyms:
          - state
          - condition
          - situation
          - position
          - phase
          - standing
          - level
          - category
      - name: JOB_PRIORITY
        expr: JOB_PRIORITY
        data_type: VARCHAR(16777216)
        description: The level of importance assigned to a job, indicating its relative urgency and impact on the organization, with possible values being Medium, High, or Low.
        sample_values:
          - Medium
          - High
          - Low
        synonyms:
          - job_importance
          - priority_level
          - task_urgency
          - job_severity
          - task_priority
          - urgency_level
          - importance_level
    time_dimensions:
      - name: DUE_DATE
        expr: DUE_DATE
        data_type: DATE
        description: The date by which a job is expected to be completed.
        sample_values:
          - '2025-03-26'
          - '2025-03-29'
          - '2025-03-28'
        synonyms:
          - target_date
          - deadline
          - due_time
          - expected_completion_date
          - scheduled_completion_date
          - end_date
          - completion_date
          - target_completion_date
      - name: CREATED_AT
        expr: CREATED_AT
        data_type: DATE
        description: Date when the job was created.
        sample_values:
          - '2025-02-25'
          - '2025-02-26'
          - '2025-03-06'
        synonyms:
          - created_date
          - creation_time
          - date_created
          - timestamp
          - insertion_time
          - registration_date
          - start_date
          - initialization_time
    primary_key:
      columns:
        - CUSTOMER_ID
        - JOB_ID
    description: This table stores information about jobs or tasks, including their unique identifier, name, associated customer, current status, priority level, due date, and creation date, allowing for tracking and management of jobs throughout their lifecycle.
    synonyms:
      - jobs
      - tasks
      - positions
      - roles
      - assignments
      - workorders
      - projects
      - operations
      - functions
      - occupations
  - name: JOB_PROCESS_STEPS
    base_table:
      database: CORTEX_AGENTS_DEMO
      schema: HEIDELBERG
      table: JOB_PROCESS_STEPS
    dimensions:
      - name: STEP_ID
        expr: STEP_ID
        data_type: VARCHAR(16777216)
        description: Unique identifier for each step in the job process.
        sample_values:
          - STEP_1
          - STEP_2
          - STEP_3
        synonyms:
          - step_number
          - process_step_id
          - job_step_identifier
          - sequence_id
          - step_identifier
          - process_step_number
      - name: JOB_ID
        expr: JOB_ID
        data_type: VARCHAR(16777216)
        description: Unique identifier for a job or process, used to track and manage individual jobs or processes within the system.
        sample_values:
          - JOB_000101
          - JOB_000102
          - JOB_000103
        synonyms:
          - job_reference
          - process_id
          - task_identifier
          - workflow_id
          - batch_number
      - name: SEQUENCE_NAME
        expr: SEQUENCE_NAME
        data_type: VARCHAR(16777216)
        description: The SEQUENCE_NAME column represents the specific stage or step in the job processing workflow, indicating the current or planned activity being performed on a job, such as proofing, imposition, or preparation.
        sample_values:
          - Proof
          - Imposition
          - Prepare
        synonyms:
          - step_sequence
          - sequence_id
          - step_order
          - process_sequence
          - job_sequence
          - sequence_number
      - name: STATUS
        expr: STATUS
        data_type: VARCHAR(16777216)
        description: The current state of a job process step, indicating whether it has been finished (Completed) or is still being worked on (In Progress).
        sample_values:
          - Completed
          - In Progress
        synonyms:
          - state
          - condition
          - situation
          - position
          - phase
          - stage
          - progress
          - outcome
    time_dimensions:
      - name: STARTED_AT
        expr: STARTED_AT
        data_type: TIMESTAMP_NTZ(9)
        description: The date and time when each job process step was started.
        sample_values:
          - '2025-03-02T14:40:30Z'
          - '2025-02-28T14:40:30Z'
          - '2025-03-03T14:40:30Z'
        synonyms:
          - initiated_at
          - start_time
          - beginning_time
          - kickoff_time
          - commencement_time
          - launch_time
      - name: COMPLETED_AT
        expr: COMPLETED_AT
        data_type: TIMESTAMP_NTZ(9)
        description: The date and time when a job process step was completed, in Coordinated Universal Time (UTC) format.
        sample_values:
          - '2025-03-06T14:40:30Z'
          - '2025-03-07T14:40:30Z'
        synonyms:
          - finished_at
          - completed_date
          - end_time
          - finished_date
          - completion_time
          - end_date
          - finished_timestamp
    primary_key:
      columns:
        - JOB_ID
    description: This table stores the execution history of job processes, tracking each step's status, start and completion timestamps, and associating them with a specific job and sequence.
    synonyms:
      - job_steps
      - process_steps
      - job_execution_steps
      - workflow_steps
      - process_execution
      - job_process
      - step_execution
      - workflow_process
      - job_sequence
      - process_sequence
  - name: CUSTOMERS
    base_table:
      database: CORTEX_AGENTS_DEMO
      schema: HEIDELBERG
      table: CUSTOMERS
    dimensions:
      - name: CUSTOMER_ID
        expr: CUSTOMER_ID
        data_type: VARCHAR(16777216)
        description: Unique identifier for each customer in the database, used to distinguish and track individual customer records.
        sample_values:
          - C_000001
          - C_000002
          - C_000003
        synonyms:
          - client_id
          - customer_number
          - account_id
          - client_number
          - account_holder_id
          - user_id
      - name: CUSTOMER_NAME
        expr: CUSTOMER_NAME
        data_type: VARCHAR(16777216)
        description: The name of the customer company.
        synonyms:
          - full_name
          - customer_name
          - company_name
          - organization_name
          - client_name
          - title
        cortex_search_service:
          database: CORTEX_AGENTS_DEMO
          schema: HEIDELBERG
          service: SEARCH_CUSTOMER_NAME
      - name: CONTACT_PERSON
        expr: CONTACT_PERSON
        data_type: VARCHAR(16777216)
        description: The name of the person who is the primary point of contact for the customer.
        synonyms:
          - key_contact
          - main_contact
          - point_of_contact
          - primary_contact
          - account_manager
          - representative
          - liaison
          - main_point_of_contact
        cortex_search_service:
          database: CORTEX_AGENTS_DEMO
          schema: HEIDELBERG
          service: SEARCH_CONTACT_PERSON
      - name: EMAIL
        expr: EMAIL
        data_type: VARCHAR(16777216)
        description: The email address of the customer.
        sample_values:
          - john@acme.com
          - alice@fastprint.com
          - mark@hqpress.com
        synonyms:
          - email_address
          - contact_email
          - electronic_mail
          - mail_address
          - email_id
      - name: PHONE_NUMBER
        expr: PHONE_NUMBER
        data_type: VARCHAR(16777216)
        description: The phone number of the customer in international format.
        sample_values:
          - +49 123 456 7890
          - +49 987 654 3210
          - +49 234 567 8901
        synonyms:
          - phone
          - contact_number
          - mobile_number
          - landline_number
          - telephone_number
          - contact_phone
      - expr: COUNTRY
        name: COUNTRY
        data_type: VARCHAR(16777216)
        description: The country of residence or origin of the customer.
        synonyms:
          - nation
          - land
          - territory
          - state
          - region
          - nationality
          - homeland
          - territory_name
        cortex_search_service:
          database: CORTEX_AGENTS_DEMO
          schema: HEIDELBERG
          service: SEARCH_COUNTRY
      - expr: CITY
        name: CITY
        data_type: VARCHAR(16777216)
        description: The city where the customer is located.
        synonyms:
          - town
          - municipality
          - metropolis
          - urban_area
          - location
          - municipality_name
          - urban_center
          - geographical_location
        cortex_search_service:
          database: CORTEX_AGENTS_DEMO
          schema: HEIDELBERG
          service: SEARCH_CITY
      - expr: STREET_ADDRESS
        name: STREET_ADDRESS
        synonyms:
          - physical_address
          - mailing_address
          - location
          - residence
          - home_address
          - postal_address
          - geographical_address
        description: The physical location of the customer's residence or business, including the street number, street name, and any relevant apartment or suite numbers.
        data_type: VARCHAR(16777216)
        sample_values:
          - 904, boulevard Émilie Laine
          - 'Avenida de Dan Tenorio 69 Puerta 5 '
          - Armin-Rieger-Platz 4/7
    primary_key:
      columns:
        - CUSTOMER_ID
    description: The CUSTOMERS table stores information about individual customers, including their unique identifier, name, primary contact person, email address, country of origin, physical address, and phone number, providing a centralized repository for customer data management.
    synonyms:
      - clients
      - patrons
      - buyers
      - consumers
      - customer_base
      - customer_list
      - customer_roster
      - account_holders
      - subscribers
      - end_users
      - users
      - accounts
      - profiles
      - records
      - entries
      - listings
      - registry
      - directory
      - roster
      - database
      - repository
      - catalog
      - index
      - ledger
      - register
      - roll
      - file
      - dossier
      - portfolio
      - collection
      - archive
      - repository
      - clientele
      - patrons_list
      - customer_database
      - customer_registry
      - customer_catalog
      - customer_index
      - customer_ledger
      - customer_register
      - customer_roll
      - customer_file
      - customer_dossier
      - customer_portfolio
      - customer_collection
      - customer_archive
      - customer_repository
relationships:
  - name: jobs_customers
    join_type: inner
    relationship_type: one_to_one
    left_table: JOBS
    relationship_columns:
      - left_column: CUSTOMER_ID
        right_column: CUSTOMER_ID
    right_table: CUSTOMERS
  - join_type: inner
    relationship_type: one_to_one
    left_table: JOB_PROCESS_STEPS
    relationship_columns:
      - left_column: JOB_ID
        right_column: JOB_ID
    right_table: JOBS
    name: steps_job
verified_queries:
  - name: uk_jobs_completed
    question: How many jobs were completed for customers in UK?
    use_as_onboarding_question: true
    sql: SELECT MIN(j.created_at) AS start_date, MAX(j.created_at) AS end_date, COUNT(DISTINCT j.job_id) AS completed_jobs_count FROM jobs AS j INNER JOIN customers AS c ON j.customer_id = c.customer_id WHERE c.country = 'United Kingdom' AND j.status = 'Completed'
    verified_by: Michael Gorkow
    verified_at: 1741645868
  - name: cancellation_rate_per_country
    question: For each country, calculate the percentage of jobs that are pending, in progress, completed and canceled.
    use_as_onboarding_question: true
    sql: WITH job_stats AS (SELECT c.country, COUNT(j.job_id) AS total_jobs, COUNT(CASE WHEN j.status = 'Pending' THEN j.job_id END) AS pending_jobs, COUNT(CASE WHEN j.status = 'Completed' THEN j.job_id END) AS completed_jobs, COUNT(CASE WHEN j.status = 'Canceled' THEN j.job_id END) AS canceled_jobs, MIN(j.created_at) AS start_date, MAX(j.created_at) AS end_date FROM jobs AS j INNER JOIN customers AS c ON j.customer_id = c.customer_id GROUP BY c.country) SELECT country, start_date, end_date, CAST(pending_jobs AS FLOAT) / NULLIF(NULLIF(total_jobs, 0), 0) AS pending_ratio, CAST(completed_jobs AS FLOAT) / NULLIF(NULLIF(total_jobs, 0), 0) AS completed_ratio, CAST(canceled_jobs AS FLOAT) / NULLIF(NULLIF(total_jobs, 0), 0) AS canceled_ratio FROM job_stats ORDER BY country /* Generated by Cortex Analyst */
    verified_by: Michael Gorkow
    verified_at: 1741646292
  - name: job_country_trend_last_30_days
    question: Show a trend of job statuses over the last 30 days for each country.
    use_as_onboarding_question: true
    sql: WITH job_stats AS (SELECT c.country, DATE_TRUNC('DAY', j.created_at) AS job_date, COUNT(j.job_id) AS total_jobs, COUNT(CASE WHEN j.status = 'Pending' THEN j.job_id END) AS pending_jobs, COUNT(CASE WHEN j.status = 'Completed' THEN j.job_id END) AS completed_jobs, COUNT(CASE WHEN j.status = 'Canceled' THEN j.job_id END) AS canceled_jobs FROM jobs AS j INNER JOIN customers AS c ON j.customer_id = c.customer_id WHERE j.created_at >= DATEADD(DAY, -30, CURRENT_DATE) GROUP BY c.country, DATE_TRUNC('DAY', j.created_at)) SELECT country, job_date, total_jobs, pending_jobs, completed_jobs, canceled_jobs, CAST(pending_jobs AS FLOAT) / NULLIF(NULLIF(total_jobs, 0), 0) AS pending_ratio, CAST(completed_jobs AS FLOAT) / NULLIF(NULLIF(total_jobs, 0), 0) AS completed_ratio, CAST(canceled_jobs AS FLOAT) / NULLIF(NULLIF(total_jobs, 0), 0) AS canceled_ratio FROM job_stats ORDER BY job_date DESC NULLS LAST, country /* Generated by Cortex Analyst */
    verified_by: Michael Gorkow
    verified_at: 1741646443